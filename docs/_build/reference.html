<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>WebOb Reference &mdash; WebOb v0.9.8 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.8',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="WebOb v0.9.8 documentation" href="index.html" />
    <link rel="next" title="webob – Request/Response objects" href="modules/webob.html" />
    <link rel="prev" title="WebOb" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="modules/webob.html" title="webob – Request/Response objects"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="WebOb"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">WebOb v0.9.8 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="webob-reference">
<h1><a class="toc-backref" href="#id6">WebOb Reference</a><a class="headerlink" href="#webob-reference" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#webob-reference" id="id6">WebOb Reference</a><ul>
<li><a class="reference internal" href="#introduction" id="id7">Introduction</a></li>
<li><a class="reference internal" href="#id1" id="id8">Request</a><ul>
<li><a class="reference internal" href="#request-body" id="id9">Request Body</a></li>
<li><a class="reference internal" href="#method-url" id="id10">Method &amp; URL</a></li>
<li><a class="reference internal" href="#headers" id="id11">Headers</a></li>
<li><a class="reference internal" href="#query-post-variables" id="id12">Query &amp; POST variables</a><ul>
<li><a class="reference internal" href="#unicode-variables" id="id13">Unicode Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cookies" id="id14">Cookies</a></li>
<li><a class="reference internal" href="#modifying-the-request" id="id15">Modifying the request</a></li>
<li><a class="reference internal" href="#header-getters" id="id16">Header Getters</a><ul>
<li><a class="reference internal" href="#accept-headers" id="id17">Accept-* headers</a></li>
<li><a class="reference internal" href="#conditional-requests" id="id18">Conditional Requests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calling-wsgi-applications" id="id19">Calling WSGI Applications</a></li>
<li><a class="reference internal" href="#ad-hoc-attributes" id="id20">Ad-Hoc Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2" id="id21">Response</a><ul>
<li><a class="reference internal" href="#core-attributes" id="id22">Core Attributes</a></li>
<li><a class="reference internal" href="#id3" id="id23">Headers</a></li>
<li><a class="reference internal" href="#body-app-iter" id="id24">Body &amp; app_iter</a></li>
<li><a class="reference internal" href="#id4" id="id25">Header Getters</a></li>
<li><a class="reference internal" href="#id5" id="id26">Cookies</a></li>
<li><a class="reference internal" href="#binding-a-request" id="id27">Binding a Request</a></li>
<li><a class="reference internal" href="#response-as-a-wsgi-application" id="id28">Response as a WSGI application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exceptions" id="id29">Exceptions</a><ul>
<li><a class="reference internal" href="#conditional-wsgi-application" id="id30">Conditional WSGI Application</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id7">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document covers all the details of the Request and Response
objects.  It is written to be testable with <a class="reference external" href="http://python.org/doc/current/lib/module-doctest.html">doctest</a> &#8211; this
effects the flavor of the documentation, perhaps to its detriment.
But it also means you can feel confident that the documentation is
correct.</p>
<p>This is a somewhat different approach to reference documentation
compared to the extracted documentation for the <a class="reference external" href="class-webob.Request.html">request</a> and <a class="reference external" href="class-webob.Response.html">response</a>.</p>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id8">Request</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The primary object in WebOb is <tt class="docutils literal"><span class="pre">webob.Request</span></tt>, a wrapper around a
<a class="reference external" href="http://www.python.org/dev/peps/pep-0333/">WSGI environment</a>.</p>
<p>The basic way you create a request object is simple enough:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob</span> <span class="kn">import</span> <span class="n">Request</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environ</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;wsgi.url_scheme&#39;</span><span class="p">:</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>  <span class="c">#doctest: +SKIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>                      <span class="c">#doctest: +SKIP</span>
</pre></div>
</div>
<p>(Note that the WSGI environment is a dictionary with a dozen required
keys, so it&#8217;s a bit lengthly to show a complete example of what it
would look like &#8211; usually your WSGI server will create it.)</p>
<p>The request object <em>wraps</em> the environment; it has very little
internal state of its own.  Instead attributes you access read and
write to the environment dictionary.</p>
<p>You don&#8217;t have to understand the details of WSGI to use this library;
this library handles those details for you.  You also don&#8217;t have to
use this exclusively of other libraries.  If those other libraries
also keep their state in the environment, multiple wrappers can
coexist.  Examples of libraries that can coexist include
<a class="reference external" href="http://pythonpaste.org/class-paste.wsgiwrappers.WSGIRequest.html">paste.wsgiwrappers.Request</a>
(used by Pylons) and <a class="reference external" href="http://lukearno.com/projects/yaro/">yaro.Request</a>.</p>
<p>The WSGI environment has a number of required variables.  To make it
easier to test and play around with, the <tt class="docutils literal"><span class="pre">Request</span></tt> class has a
constructor that will fill in a minimal environment:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/article?id=1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="go">{&#39;HTTP_HOST&#39;: &#39;localhost:80&#39;,</span>
<span class="go"> &#39;PATH_INFO&#39;: &#39;/article&#39;,</span>
<span class="go"> &#39;QUERY_STRING&#39;: &#39;id=1&#39;,</span>
<span class="go"> &#39;REQUEST_METHOD&#39;: &#39;GET&#39;,</span>
<span class="go"> &#39;SCRIPT_NAME&#39;: &#39;&#39;,</span>
<span class="go"> &#39;SERVER_NAME&#39;: &#39;localhost&#39;,</span>
<span class="go"> &#39;SERVER_PORT&#39;: &#39;80&#39;,</span>
<span class="go"> &#39;SERVER_PROTOCOL&#39;: &#39;HTTP/1.0&#39;,</span>
<span class="go"> &#39;wsgi.errors&#39;: &lt;open file &#39;&lt;stderr&gt;&#39;, mode &#39;w&#39; at ...&gt;,</span>
<span class="go"> &#39;wsgi.input&#39;: &lt;...cStringIO... object at ...&gt;,</span>
<span class="go"> &#39;wsgi.multiprocess&#39;: False,</span>
<span class="go"> &#39;wsgi.multithread&#39;: False,</span>
<span class="go"> &#39;wsgi.run_once&#39;: False,</span>
<span class="go"> &#39;wsgi.url_scheme&#39;: &#39;http&#39;,</span>
<span class="go"> &#39;wsgi.version&#39;: (1, 0)}</span>
</pre></div>
</div>
<div class="section" id="request-body">
<h3><a class="toc-backref" href="#id9">Request Body</a><a class="headerlink" href="#request-body" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">req.body</span></tt> is a file-like object that gives the body of the request
(e.g., a POST form, the body of a PUT, etc).  It&#8217;s kind of boring to
start, but you can set it to a string and that will be turned into a
file-like object.  You can read the entire body with
<tt class="docutils literal"><span class="pre">req.body</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cStringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">body_file</span><span class="p">,</span> <span class="n">cStringIO</span><span class="o">.</span><span class="n">InputType</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s">&#39;test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">body_file</span><span class="p">,</span> <span class="n">cStringIO</span><span class="o">.</span><span class="n">InputType</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;test&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="method-url">
<h3><a class="toc-backref" href="#id10">Method &amp; URL</a><a class="headerlink" href="#method-url" title="Permalink to this headline">¶</a></h3>
<p>All the normal parts of a request are also accessible through the
request object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">method</span>
<span class="go">&#39;GET&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">scheme</span>
<span class="go">&#39;http&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">script_name</span>  <span class="c"># The base of the URL</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">script_name</span> <span class="o">=</span> <span class="s">&#39;/blog&#39;</span> <span class="c"># make it more interesting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_info</span>    <span class="c"># The yet-to-be-consumed part of the URL</span>
<span class="go">&#39;/article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">content_type</span> <span class="c"># Content-Type of the request body</span>
<span class="go">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">req</span><span class="o">.</span><span class="n">remote_user</span>  <span class="c"># The authenticated user (there is none set)</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">req</span><span class="o">.</span><span class="n">remote_addr</span>  <span class="c"># The remote IP</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">host</span>
<span class="go">&#39;localhost:80&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">host_url</span>
<span class="go">&#39;http://localhost&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">application_url</span>
<span class="go">&#39;http://localhost/blog&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_url</span>
<span class="go">&#39;http://localhost/blog/article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">url</span>
<span class="go">&#39;http://localhost/blog/article?id=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path</span>
<span class="go">&#39;/blog/article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_qs</span>
<span class="go">&#39;/blog/article?id=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">query_string</span>
<span class="go">&#39;id=1&#39;</span>
</pre></div>
</div>
<p>You can make new URLs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">relative_url</span><span class="p">(</span><span class="s">&#39;archive&#39;</span><span class="p">)</span>
<span class="go">&#39;http://localhost/blog/archive&#39;</span>
</pre></div>
</div>
<p>For parsing the URLs, it is often useful to deal with just the next
path segment on PATH_INFO:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_info_peek</span><span class="p">()</span> <span class="c"># Doesn&#39;t change request</span>
<span class="go">&#39;article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_info_pop</span><span class="p">()</span>  <span class="c"># Does change request!</span>
<span class="go">&#39;article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">script_name</span>
<span class="go">&#39;/blog/article&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">path_info</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="headers">
<h3><a class="toc-backref" href="#id11">Headers</a><a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h3>
<p>All request headers are available through a dictionary-like object
<tt class="docutils literal"><span class="pre">req.headers</span></tt>.  Keys are case-insensitive.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob.compat</span> <span class="kn">import</span> <span class="n">sorted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Content-Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;application/x-www-urlencoded&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sorted</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;Content-Length&#39;, &#39;4&#39;), (&#39;Content-Type&#39;, &#39;application/x-www-urlencoded&#39;), (&#39;Host&#39;, &#39;localhost:80&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;CONTENT_TYPE&#39;</span><span class="p">]</span>
<span class="go">&#39;application/x-www-urlencoded&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="query-post-variables">
<h3><a class="toc-backref" href="#id12">Query &amp; POST variables</a><a class="headerlink" href="#query-post-variables" title="Permalink to this headline">¶</a></h3>
<p>Requests can have variables in one of two locations: the query string
(<tt class="docutils literal"><span class="pre">?id=1</span></tt>), or in the body of the request (generally a POST form).
Note that even POST requests can have a query string, so both kinds of
variables can exist at the same time.  Also, a variable can show up
more than once, as in <tt class="docutils literal"><span class="pre">?check=a&amp;check=b</span></tt>.</p>
<p>For these variables WebOb uses a <a class="reference external" href="class-webob.multidict.MultiDict.html">MultiDict</a>, which is basically a
dictionary wrapper on a list of key/value pairs.  It looks like a
single-valued dictionary, but you can access all the values of a key
with <tt class="docutils literal"><span class="pre">.getall(key)</span></tt> (which always returns a list, possibly an empty
list).  You also get all key/value pairs when using <tt class="docutils literal"><span class="pre">.items()</span></tt> and
all values with <tt class="docutils literal"><span class="pre">.values()</span></tt>.</p>
<p>Some examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/test?check=a&amp;check=b&amp;name=Bob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span>
<span class="go">GET([(&#39;check&#39;, &#39;a&#39;), (&#39;check&#39;, &#39;b&#39;), (&#39;name&#39;, &#39;Bob&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s">&#39;check&#39;</span><span class="p">]</span>
<span class="go">&#39;b&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">getall</span><span class="p">(</span><span class="s">&#39;check&#39;</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">[(&#39;check&#39;, &#39;a&#39;), (&#39;check&#39;, &#39;b&#39;), (&#39;name&#39;, &#39;Bob&#39;)]</span>
</pre></div>
</div>
<p>We&#8217;ll have to create a request body and change the method to get
POST.  Until we do that, the variables are boring:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">POST</span>
<span class="go">&lt;NoVars: Not a form request&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>  <span class="c"># NoVars can be read like a dict, but not written</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#39;POST&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s">&#39;name=Joe&amp;email=joe@example.com&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">POST</span>
<span class="go">MultiDict([(&#39;name&#39;, &#39;Joe&#39;), (&#39;email&#39;, &#39;joe@example.com&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">&#39;Joe&#39;</span>
</pre></div>
</div>
<p>Often you won&#8217;t care where the variables come from.  (Even if you care
about the method, the location of the variables might not be
important.)  There is a dictionary called <tt class="docutils literal"><span class="pre">req.params</span></tt> that
contains variables from both sources:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">params</span>
<span class="go">NestedMultiDict([(&#39;check&#39;, &#39;a&#39;), (&#39;check&#39;, &#39;b&#39;), (&#39;name&#39;, &#39;Bob&#39;), (&#39;name&#39;, &#39;Joe&#39;), (&#39;email&#39;, &#39;joe@example.com&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
<span class="go">&#39;Bob&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">getall</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="go">[&#39;Bob&#39;, &#39;Joe&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="go">check: &#39;a&#39;</span>
<span class="go">check: &#39;b&#39;</span>
<span class="go">name: &#39;Bob&#39;</span>
<span class="go">name: &#39;Joe&#39;</span>
<span class="go">email: &#39;joe@example.com&#39;</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">POST</span></tt> and <tt class="docutils literal"><span class="pre">GET</span></tt> nomenclature is historical &#8211; <tt class="docutils literal"><span class="pre">req.GET</span></tt> can
be used for non-GET requests to access query parameters, and
<tt class="docutils literal"><span class="pre">req.POST</span></tt> can also be used for PUT requests with the appropriate
Content-Type.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/test?check=a&amp;check=b&amp;name=Bob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#39;PUT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">body</span> <span class="o">=</span> <span class="s">&#39;var1=value1&amp;var2=value2&amp;rep=1&amp;rep=2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;CONTENT_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;CONTENT_TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;application/x-www-form-urlencoded&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span>
<span class="go">GET([(&#39;check&#39;, &#39;a&#39;), (&#39;check&#39;, &#39;b&#39;), (&#39;name&#39;, &#39;Bob&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">POST</span>
<span class="go">MultiDict([(&#39;var1&#39;, &#39;value1&#39;), (&#39;var2&#39;, &#39;value2&#39;), (&#39;rep&#39;, &#39;1&#39;), (&#39;rep&#39;, &#39;2&#39;)])</span>
</pre></div>
</div>
<div class="section" id="unicode-variables">
<h4><a class="toc-backref" href="#id13">Unicode Variables</a><a class="headerlink" href="#unicode-variables" title="Permalink to this headline">¶</a></h4>
<p>Submissions are non-unicode (<tt class="docutils literal"><span class="pre">str</span></tt>) strings, unless some character
set is indicated.  A client can indicate the character set with
<tt class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">application/x-www-form-urlencoded;</span> <span class="pre">charset=utf8</span></tt>, but
very few clients actually do this (sometimes XMLHttpRequest requests
will do this, as JSON is always UTF8 even when a page is served with a
different character set).  You can force a charset, which will effect
all the variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">charset</span> <span class="o">=</span> <span class="s">&#39;utf8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">GET</span>
<span class="go">UnicodeMultiDict([(&#39;check&#39;, u&#39;a&#39;), (&#39;check&#39;, u&#39;b&#39;), (&#39;name&#39;, u&#39;Bob&#39;)])</span>
</pre></div>
</div>
<p>If you always want <tt class="docutils literal"><span class="pre">str</span></tt> values, you can use <tt class="docutils literal"><span class="pre">req.str_GET</span></tt>
and <tt class="docutils literal"><span class="pre">str_POST</span></tt>.</p>
</div>
</div>
<div class="section" id="cookies">
<h3><a class="toc-backref" href="#id14">Cookies</a><a class="headerlink" href="#cookies" title="Permalink to this headline">¶</a></h3>
<p>Cookies are presented in a simple dictionary.  Like other variables,
they will be decoded into Unicode strings if you set the charset.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Cookie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;test=value&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">cookies</span>
<span class="go">UnicodeMultiDict([(&#39;test&#39;, u&#39;value&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">charset</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">cookies</span>
<span class="go">{&#39;test&#39;: &#39;value&#39;}</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-the-request">
<h3><a class="toc-backref" href="#id15">Modifying the request</a><a class="headerlink" href="#modifying-the-request" title="Permalink to this headline">¶</a></h3>
<p>The headers are all modifiable, as are other environmental variables
(like <tt class="docutils literal"><span class="pre">req.remote_user</span></tt>, which maps to
<tt class="docutils literal"><span class="pre">request.environ['REMOTE_USER']</span></tt>).</p>
<p>If you want to copy the request you can use <tt class="docutils literal"><span class="pre">req.copy()</span></tt>; this
copies the <tt class="docutils literal"><span class="pre">environ</span></tt> dictionary, and the request body from
<tt class="docutils literal"><span class="pre">environ['wsgi.input']</span></tt>.</p>
<p>The method <tt class="docutils literal"><span class="pre">req.remove_conditional_headers(remove_encoding=True)</span></tt>
can be used to remove headers that might result in a <tt class="docutils literal"><span class="pre">304</span> <span class="pre">Not</span>
<span class="pre">Modified</span></tt> response.  If you are writing some intermediary it can be
useful to avoid these headers.  Also if <tt class="docutils literal"><span class="pre">remove_encoding</span></tt> is true
(the default) then any <tt class="docutils literal"><span class="pre">Accept-Encoding</span></tt> header will be removed,
which can result in gzipped responses.</p>
</div>
<div class="section" id="header-getters">
<h3><a class="toc-backref" href="#id16">Header Getters</a><a class="headerlink" href="#header-getters" title="Permalink to this headline">¶</a></h3>
<p>In addition to <tt class="docutils literal"><span class="pre">req.headers</span></tt>, there are attributes for most of the
request headers defined by the HTTP 1.1 specification.  These
attributes often return parsed forms of the headers.</p>
<div class="section" id="accept-headers">
<h4><a class="toc-backref" href="#id17">Accept-* headers</a><a class="headerlink" href="#accept-headers" title="Permalink to this headline">¶</a></h4>
<p>There are several request headers that tell the server what the client
accepts.  These are <tt class="docutils literal"><span class="pre">accept</span></tt> (the Content-Type that is accepted),
<tt class="docutils literal"><span class="pre">accept_charset</span></tt> (the charset accepted), <tt class="docutils literal"><span class="pre">accept_encoding</span></tt>
(the Content-Encoding, like gzip, that is accepted), and
<tt class="docutils literal"><span class="pre">accept_language</span></tt> (generally the preferred language of the client).</p>
<p>The objects returned support containment to test for acceptability.
E.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;text/html&#39;</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">accept</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Because no header means anything is potentially acceptable, this is
returning True.  We can set it to see more interesting behavior (the
example means that <tt class="docutils literal"><span class="pre">text/html</span></tt> is okay, but
<tt class="docutils literal"><span class="pre">application/xhtml+xml</span></tt> is preferred):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span> <span class="o">=</span> <span class="s">&#39;text/html;q=0.5, application/xhtml+xml;q=1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span>
<span class="go">&lt;MIMEAccept at ... Accept: text/html;q=0.5, application/xhtml+xml&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;text/html&#39;</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">accept</span>
<span class="go">True</span>
</pre></div>
</div>
<p>There&#8217;s three methods for different strategies of finding a match.
First, when you trust the server&#8217;s preference over the client (a good
idea for Accept):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">first_match</span><span class="p">([</span><span class="s">&#39;text/html&#39;</span><span class="p">,</span> <span class="s">&#39;application/xhtml+xml&#39;</span><span class="p">])</span>
<span class="go">&#39;text/html&#39;</span>
</pre></div>
</div>
<p>Because <tt class="docutils literal"><span class="pre">text/html</span></tt> is at least <em>somewhat</em> acceptible, it is
returned, even if the client says it prefers
<tt class="docutils literal"><span class="pre">application/xhtml+xml</span></tt>.  If we trust the client more:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">best_match</span><span class="p">([</span><span class="s">&#39;text/html&#39;</span><span class="p">,</span> <span class="s">&#39;application/xhtml+xml&#39;</span><span class="p">])</span>
<span class="go">&#39;application/xhtml+xml&#39;</span>
</pre></div>
</div>
<p>If we just want to know everything the client prefers, in the order it
is preferred:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">best_matches</span><span class="p">()</span>
<span class="go">[&#39;application/xhtml+xml&#39;, &#39;text/html&#39;]</span>
</pre></div>
</div>
<p>For languages you&#8217;ll often have a &#8220;fallback&#8221; language.  E.g., if there&#8217;s
nothing better then use <tt class="docutils literal"><span class="pre">en-US</span></tt> (and if <tt class="docutils literal"><span class="pre">en-US</span></tt> is okay, ignore
any less preferrable languages):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept_language</span> <span class="o">=</span> <span class="s">&#39;es, pt-BR&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept_language</span><span class="o">.</span><span class="n">best_matches</span><span class="p">(</span><span class="s">&#39;en-US&#39;</span><span class="p">)</span>
<span class="go">[&#39;es&#39;, &#39;pt-BR&#39;, &#39;en-US&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept_language</span><span class="o">.</span><span class="n">best_matches</span><span class="p">(</span><span class="s">&#39;es&#39;</span><span class="p">)</span>
<span class="go">[&#39;es&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="conditional-requests">
<h4><a class="toc-backref" href="#id18">Conditional Requests</a><a class="headerlink" href="#conditional-requests" title="Permalink to this headline">¶</a></h4>
<p>There a number of ways to make a conditional request.  A conditional
request is made when the client has a document, but it is not sure if
the document is up to date.  If it is not, it wants a new version.  If
the document is up to date then it doesn&#8217;t want to waste the
bandwidth, and expects a <tt class="docutils literal"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></tt> response.</p>
<p>ETags are generally the best technique for these kinds of requests;
this is an opaque string that indicates the identity of the object.
For instance, it&#8217;s common to use the mtime (last modified) of the file,
plus the number of bytes, and maybe a hash of the filename (if there&#8217;s
a possibility that the same URL could point to two different
server-side filenames based on other variables).  To test if a 304
response is appropriate, you can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="o">=</span> <span class="s">&#39;opaque-token&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span> <span class="c"># You shouldn&#39;t return 304</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span> <span class="o">=</span> <span class="n">server_token</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span>
<span class="go">&lt;ETag opaque-token&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span> <span class="c"># You *should* return 304</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For date-based comparisons If-Modified-Since is used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob</span> <span class="kn">import</span> <span class="n">UTC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_modified_since</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mf">2006</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">UTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;If-Modified-Since&#39;</span><span class="p">]</span>
<span class="go">&#39;Sun, 01 Jan 2006 12:00:00 GMT&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mf">2005</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">UTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_modified_since</span> <span class="ow">and</span> <span class="n">req</span><span class="o">.</span><span class="n">if_modified_since</span> <span class="o">&gt;=</span> <span class="n">server_modified</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For range requests there are two important headers, If-Range (which is
form of conditional request) and Range (which requests a range).  If
the If-Range header fails to match then the full response (not a
range) should be returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span>
<span class="go">&lt;Empty If-Range&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">etag</span><span class="o">=</span><span class="s">&#39;some-etag&#39;</span><span class="p">,</span> <span class="n">last_modified</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mf">2005</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span> <span class="o">=</span> <span class="s">&#39;opaque-etag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">etag</span><span class="o">=</span><span class="s">&#39;other-etag&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">etag</span><span class="o">=</span><span class="s">&#39;opaque-etag&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You can also pass in a response object with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob</span> <span class="kn">import</span> <span class="n">Response</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">etag</span><span class="o">=</span><span class="s">&#39;opaque-etag&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_range</span><span class="o">.</span><span class="n">match_response</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>To get the range information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="s">&#39;bytes=0-100&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">range</span>
<span class="go">&lt;Range ranges=(0, 101)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cr</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">content_range</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cr</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">cr</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">cr</span><span class="o">.</span><span class="n">length</span>
<span class="go">(0, 101, 1000)</span>
</pre></div>
</div>
<p>Note that the range headers use <em>inclusive</em> ranges (the last byte
indexed is included), where Python always uses a range where the last
index is excluded from the range.  The <tt class="docutils literal"><span class="pre">.stop</span></tt> index is in the
Python form.</p>
<p>Another kind of conditional request is a request (typically PUT) that
includes If-Match or If-Unmodified-Since.  In this case you are saying
&#8220;here is an update to a resource, but don&#8217;t apply it if someone else
has done something since I last got the resource&#8221;.  If-Match means &#8220;do
this if the current ETag matches the ETag I&#8217;m giving&#8221;.
If-Unmodified-Since means &#8220;do this if the resource has remained
unchanged&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">if_match</span> <span class="c"># No If-Match means everything is ok</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_match</span> <span class="o">=</span> <span class="n">server_token</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">if_match</span> <span class="c"># Still OK</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_match</span> <span class="o">=</span> <span class="s">&#39;other-token&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Not OK, should return 412 Precondition Failed:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">server_token</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">if_match</span>
<span class="go">False</span>
</pre></div>
</div>
<p>For more on this kind of conditional request, see <a class="reference external" href="http://www.w3.org/1999/04/Editing/">Detecting the Lost
Update Problem Using Unreserved Checkout</a>.</p>
</div>
</div>
<div class="section" id="calling-wsgi-applications">
<h3><a class="toc-backref" href="#id19">Calling WSGI Applications</a><a class="headerlink" href="#calling-wsgi-applications" title="Permalink to this headline">¶</a></h3>
<p>The request object can be used to make handy subrequests or test
requests against WSGI applications.  If you want to make subrequests,
you should copy the request (with <tt class="docutils literal"><span class="pre">req.copy()</span></tt>) before sending it to
multiple applications, since applications might modify the request
when they are run.</p>
<p>There&#8217;s two forms of the subrequest.  The more primitive form is
this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">wsgi_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">start_response</span><span class="p">(</span><span class="s">&#39;200 OK&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s">&#39;text/plain&#39;</span><span class="p">)])</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="s">&#39;Hi!&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">call_application</span><span class="p">(</span><span class="n">wsgi_app</span><span class="p">)</span>
<span class="go">(&#39;200 OK&#39;, [(&#39;Content-type&#39;, &#39;text/plain&#39;)], [&#39;Hi!&#39;])</span>
</pre></div>
</div>
<p>Note it returns <tt class="docutils literal"><span class="pre">(status_string,</span> <span class="pre">header_list,</span> <span class="pre">app_iter)</span></tt>.  If
<tt class="docutils literal"><span class="pre">app_iter.close()</span></tt> exists, it is your responsibility to call it.</p>
<p>A handier response can be had with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">wsgi_app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">&lt;Response ... 200 OK&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status</span>
<span class="go">&#39;200 OK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span>
<span class="go">HeaderDict([(&#39;Content-type&#39;, &#39;text/plain&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;Hi!&#39;</span>
</pre></div>
</div>
<p>You can learn more about this response object in the <a class="reference external" href="class-webob.Response.html">Response</a> section.</p>
</div>
<div class="section" id="ad-hoc-attributes">
<h3><a class="toc-backref" href="#id20">Ad-Hoc Attributes</a><a class="headerlink" href="#ad-hoc-attributes" title="Permalink to this headline">¶</a></h3>
<p>You can assign attributes to your request objects.  They will all go
in <tt class="docutils literal"><span class="pre">environ['webob.adhoc_attrs']</span></tt> (a dictionary).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">some_attr</span> <span class="o">=</span> <span class="s">&#39;blah blah blah&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_req</span><span class="o">.</span><span class="n">some_attr</span>
<span class="go">&#39;blah blah blah&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;webob.adhoc_attrs&#39;</span><span class="p">]</span>
<span class="go">{&#39;some_attr&#39;: &#39;blah blah blah&#39;}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id21">Response</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">webob.Response</span></tt> object contains everything necessary to make a
WSGI response.  Instances of it are in fact WSGI applications, but it
can also represent the result of calling a WSGI application (as noted
in <a class="reference internal" href="#calling-wsgi-applications">Calling WSGI Applications</a>).  It can also be a way of
accumulating a response in your WSGI application.</p>
<p>A WSGI response is made up of a status (like <tt class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></tt>), a list of
headers, and a body (or iterator that will produce a body).</p>
<div class="section" id="core-attributes">
<h3><a class="toc-backref" href="#id22">Core Attributes</a><a class="headerlink" href="#core-attributes" title="Permalink to this headline">¶</a></h3>
<p>The core attributes are unsurprising:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob</span> <span class="kn">import</span> <span class="n">Response</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status</span>
<span class="go">&#39;200 OK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headerlist</span>
<span class="go">[(&#39;Content-Type&#39;, &#39;text/html; charset=UTF-8&#39;), (&#39;Content-Length&#39;, &#39;0&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;&#39;</span>
</pre></div>
</div>
<p>You can set any of these attributes, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="mf">404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status</span>
<span class="go">&#39;404 Not Found&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">status_int</span>
<span class="go">404</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headerlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s">&#39;text/html&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s">&#39;test&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">res</span>
<span class="go">404 Not Found</span>
<span class="go">Content-type: text/html</span>
<span class="go">Content-Length: 4</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s">u&quot;test&quot;</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">You cannot set Response.body to a unicode object (use Response.unicode_body)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">unicode_body</span> <span class="o">=</span> <span class="s">u&quot;test&quot;</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="nc">AttributeError</span>: <span class="n-Identifier">You cannot access Response.unicode_body unless charset is set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">charset</span> <span class="o">=</span> <span class="s">&#39;utf8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">unicode_body</span> <span class="o">=</span> <span class="s">u&quot;test&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;test&#39;</span>
</pre></div>
</div>
<p>You can set any attribute with the constructor, like
<tt class="docutils literal"><span class="pre">Response(charset='utf8')</span></tt></p>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id23">Headers</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>In addition to <tt class="docutils literal"><span class="pre">res.headerlist</span></tt>, there is dictionary-like view on
the list in <tt class="docutils literal"><span class="pre">res.headers</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span>
<span class="go">HeaderDict([(&#39;Content-Type&#39;, &#39;text/html; charset=utf8&#39;), (&#39;Content-Length&#39;, &#39;4&#39;)])</span>
</pre></div>
</div>
<p>This is case-insensitive.  It can support multiple values for a key,
though only if you use <tt class="docutils literal"><span class="pre">res.headers.add(key,</span> <span class="pre">value)</span></tt> or read them
with <tt class="docutils literal"><span class="pre">res.headers.getall(key)</span></tt>.</p>
</div>
<div class="section" id="body-app-iter">
<h3><a class="toc-backref" href="#id24">Body &amp; app_iter</a><a class="headerlink" href="#body-app-iter" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">res.body</span></tt> attribute represents the entire body of the request
as a single string (not unicode, though you can set it to unicode if
you have a charset defined).  There is also a <tt class="docutils literal"><span class="pre">res.app_iter</span></tt>
attribute that reprsents the body as an iterator.  WSGI applications
return these <tt class="docutils literal"><span class="pre">app_iter</span></tt> iterators instead of strings, and sometimes
it can be problematic to load the entire iterator at once (for
instance, if it returns the contents of a very large file).  Generally
it is not a problem, and often the iterator is something simple like a
one-item list containing a string with the entire body.</p>
<p>If you set the body then Content-Length will also be set, and an
<tt class="docutils literal"><span class="pre">res.app_iter</span></tt> will be created for you.  If you set <tt class="docutils literal"><span class="pre">res.app_iter</span></tt>
then Content-Length will be cleared, but it won&#8217;t be set for you.</p>
<p>There is also a file-like object you can access, which will update the
app_iter in-place (turning the app_iter into a list if necessary):</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; res = Response(content_type='text/plain', charset=None)
&gt;&gt;&gt; f = res.body_file
&gt;&gt;&gt; f.write('hey')
&gt;&gt;&gt; f.write(u'test')
Traceback (most recent call last):
  . . .
TypeError: You can only write unicode to Response.body_file if charset has been set
&gt;&gt;&gt; f.encoding
&gt;&gt;&gt; res.charset = 'utf8'
&gt;&gt;&gt; f.encoding
'utf8'
&gt;&gt;&gt; f.write(u'test')
&gt;&gt;&gt; res.app_iter
['hey', 'test']
&gt;&gt;&gt; res.body
'heytest'</pre>
</div>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id25">Header Getters</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Like Request, HTTP response headers are also available as individual
properties.  These represent parsed forms of the headers.</p>
<p>Content-Type is a special case, as the type and the charset are
handled through two separate properties:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s">&#39;text/html&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">charset</span> <span class="o">=</span> <span class="s">&#39;utf8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_type</span>
<span class="go">&#39;text/html&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;content-type&#39;</span><span class="p">]</span>
<span class="go">&#39;text/html; charset=utf8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s">&#39;application/atom+xml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_type_params</span>
<span class="go">{&#39;charset&#39;: &#39;utf8&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_type_params</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="s">&#39;entry&#39;</span><span class="p">,</span> <span class="s">&#39;charset&#39;</span><span class="p">:</span> <span class="s">&#39;utf8&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;content-type&#39;</span><span class="p">]</span>
<span class="go">&#39;application/atom+xml; charset=utf8; type=entry&#39;</span>
</pre></div>
</div>
<p>Other headers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Used with a redirect:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s">&#39;http://localhost/foo&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Indicates that the server accepts Range requests:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">accept_ranges</span> <span class="o">=</span> <span class="s">&#39;bytes&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Used by caching proxies to tell the client how old the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># response is:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="mf">120</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Show what methods the client can do; typically used in</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># a 405 Method Not Allowed response:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">allow</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;GET&#39;</span><span class="p">,</span> <span class="s">&#39;PUT&#39;</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Set the cache-control header:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">cache_control</span><span class="o">.</span><span class="n">max_age</span> <span class="o">=</span> <span class="mf">360</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">cache_control</span><span class="o">.</span><span class="n">no_transform</span> <span class="o">=</span> <span class="bp">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Tell the browser to treat the response as an attachment:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_disposition</span> <span class="o">=</span> <span class="s">&#39;attachment; filename=foo.xml&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Used if you had gzipped the body:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_encoding</span> <span class="o">=</span> <span class="s">&#39;gzip&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># What language(s) are in the content:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_language</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;en&#39;</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Seldom used header that tells the client where the content</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># is from:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_location</span> <span class="o">=</span> <span class="s">&#39;http://localhost/foo&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Seldom used header that gives a hash of the body:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_md5</span> <span class="o">=</span> <span class="s">&#39;big-hash&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Means we are serving bytes 0-500 inclusive, out of 1000 bytes total:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># you can also use the range setter shown earlier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">501</span><span class="p">,</span> <span class="mf">1000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># The length of the content; set automatically if you set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># res.body:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">content_length</span> <span class="o">=</span> <span class="mf">4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Used to indicate the current date as the server understands</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># it:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># The etag:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">etag</span> <span class="o">=</span> <span class="s">&#39;opaque-token&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># You can generate it from the body too:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">md5_etag</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">etag</span>
<span class="go">&#39;1B2M2Y8AsgTpgAmY7PhCfg&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># When this page should expire from a cache (Cache-Control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># often works better):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">expires</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mf">60</span><span class="o">*</span><span class="mf">60</span> <span class="c"># 1 hour</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># When this was last modified, of course:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mf">2007</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">UTC</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Used with 503 Service Unavailable to hint the client when to</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># try again:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">retry_after</span> <span class="o">=</span> <span class="mf">160</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Indicate the server software:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">server</span> <span class="o">=</span> <span class="s">&#39;WebOb/1.0&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># Give a list of headers that the cache should vary on:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">vary</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Cookie&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note in each case you can general set the header to a string to avoid
any parsing, and set it to None to remove the header (or do something
like <tt class="docutils literal"><span class="pre">del</span> <span class="pre">res.vary</span></tt>).</p>
<p>In the case of date-related headers you can set the value to a
<tt class="docutils literal"><span class="pre">datetime</span></tt> instance (ideally with a UTC timezone), a time tuple, an
integer timestamp, or a properly-formatted string.</p>
<p>After setting all these headers, here&#8217;s the result:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">headerlist</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="go">Content-Type: application/atom+xml; charset=utf8; type=entry</span>
<span class="go">Location: http://localhost/foo</span>
<span class="go">Accept-Ranges: bytes</span>
<span class="go">Age: 120</span>
<span class="go">Allow: GET, PUT</span>
<span class="go">Cache-Control: max-age=360, no-transform</span>
<span class="go">Content-Disposition: attachment; filename=foo.xml</span>
<span class="go">Content-Encoding: gzip</span>
<span class="go">Content-Language: en</span>
<span class="go">Content-Location: http://localhost/foo</span>
<span class="go">Content-MD5: big-hash</span>
<span class="go">Content-Range: bytes 0-500/1000</span>
<span class="go">Content-Length: 4</span>
<span class="go">Date: ... GMT</span>
<span class="go">ETag: ...</span>
<span class="go">Expires: ... GMT</span>
<span class="go">Last-Modified: Mon, 01 Jan 2007 12:00:00 GMT</span>
<span class="go">Retry-After: 160</span>
<span class="go">Server: WebOb/1.0</span>
<span class="go">Vary: Cookie</span>
</pre></div>
</div>
<p>You can also set Cache-Control related attributes with
<tt class="docutils literal"><span class="pre">req.cache_expires(seconds,</span> <span class="pre">**attrs)</span></tt>, like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">cache_expires</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Cache-Control&#39;</span><span class="p">]</span>
<span class="go">&#39;max-age=10&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">cache_expires</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Cache-Control&#39;</span><span class="p">]</span>
<span class="go">&#39;max-age=0, must-revalidate, no-cache, no-store&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Expires&#39;</span><span class="p">]</span>
<span class="go">&#39;... GMT&#39;</span>
</pre></div>
</div>
<p>You can also use the <a class="reference external" href="http://python.org/doc/current/lib/datetime-timedelta.html">timedelta</a>
constants defined, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">cache_expires</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">day</span><span class="o">+</span><span class="mf">4</span><span class="o">*</span><span class="n">hour</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Cache-Control&#39;</span><span class="p">]</span>
<span class="go">&#39;max-age=187200&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id26">Cookies</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Cookies (and the Set-Cookie header) are handled with a couple
methods.  Most importantly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">,</span> <span class="n">max_age</span><span class="o">=</span><span class="mf">360</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s">&#39;/&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">domain</span><span class="o">=</span><span class="s">&#39;example.org&#39;</span><span class="p">,</span> <span class="n">secure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Set-Cookie&#39;</span><span class="p">]</span>
<span class="go">&#39;key=value; Domain=example.org; expires=&quot;... GMT&quot;; Max-Age=360; Path=/; secure&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># To delete a cookie previously set in the client:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">delete_cookie</span><span class="p">(</span><span class="s">&#39;bad_cookie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;Set-Cookie&#39;</span><span class="p">]</span>
<span class="go">&#39;bad_cookie=; expires=&quot;... GMT&quot;; Max-Age=0; Path=/&#39;</span>
</pre></div>
</div>
<p>The only other real method of note (note that this does <em>not</em> delete
the cookie from clients, only from the response object):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">unset_cookie</span><span class="p">(</span><span class="s">&#39;key&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">unset_cookie</span><span class="p">(</span><span class="s">&#39;bad_cookie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">res</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;Set-Cookie&#39;</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
<div class="section" id="binding-a-request">
<h3><a class="toc-backref" href="#id27">Binding a Request</a><a class="headerlink" href="#binding-a-request" title="Permalink to this headline">¶</a></h3>
<p>You can bind a request (or request WSGI environ) to the response
object.  This is available through <tt class="docutils literal"><span class="pre">res.request</span></tt> or
<tt class="docutils literal"><span class="pre">res.environ</span></tt>.  This is currently only used in setting
<tt class="docutils literal"><span class="pre">res.location</span></tt>, to make the location absolute if necessary.</p>
</div>
<div class="section" id="response-as-a-wsgi-application">
<h3><a class="toc-backref" href="#id28">Response as a WSGI application</a><a class="headerlink" href="#response-as-a-wsgi-application" title="Permalink to this headline">¶</a></h3>
<p>A response is a WSGI application, in that you can do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">status</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">app_iter</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">call_application</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
<p>A possible pattern for your application might be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">Response</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">res</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="s">&#39;text/plain&#39;</span>
<span class="gp">... </span>    <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sorted</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>        <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">res</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">res</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">my_app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">res</span>
<span class="go">200 OK</span>
<span class="go">Content-Type: text/plain; charset=UTF-8</span>
<span class="go">Content-Length: ...</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">HTTP_HOST: &#39;localhost:80&#39;</span>
<span class="go">PATH_INFO: &#39;/&#39;</span>
<span class="go">QUERY_STRING: &#39;&#39;</span>
<span class="go">REQUEST_METHOD: &#39;GET&#39;</span>
<span class="go">SCRIPT_NAME: &#39;&#39;</span>
<span class="go">SERVER_NAME: &#39;localhost&#39;</span>
<span class="go">SERVER_PORT: &#39;80&#39;</span>
<span class="go">SERVER_PROTOCOL: &#39;HTTP/1.0&#39;</span>
<span class="go">wsgi.errors: &lt;open file &#39;&lt;stderr&gt;&#39;, mode &#39;w&#39; at ...&gt;</span>
<span class="go">wsgi.input: &lt;...cStringIO... object at ...&gt;</span>
<span class="go">wsgi.multiprocess: False</span>
<span class="go">wsgi.multithread: False</span>
<span class="go">wsgi.run_once: False</span>
<span class="go">wsgi.url_scheme: &#39;http&#39;</span>
<span class="go">wsgi.version: (1, 0)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exceptions">
<h2><a class="toc-backref" href="#id29">Exceptions</a><a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<p>In addition to Request and Response objects, there are a set of Python
exceptions for different HTTP responses (3xx, 4xx, 5xx codes).</p>
<p>These provide a simple way to provide these non-200 response.  A very
simple body is provided.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">webob.exc</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exc</span> <span class="o">=</span> <span class="n">HTTPTemporaryRedirect</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/path/to/something&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">307 Temporary Redirect</span>
<span class="go">Content-Type: text/html; charset=UTF-8</span>
<span class="go">Location: http://localhost/path/to/foo</span>
<span class="go">Content-Length: 126</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">307 Temporary Redirect</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">The resource has been moved to http://localhost/path/to/foo; you should be redirected automatically.</span>
</pre></div>
</div>
<p>Note that only if there&#8217;s an <tt class="docutils literal"><span class="pre">Accept:</span> <span class="pre">text/html</span></tt> header in the
request will an HTML response be given:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">accept</span> <span class="o">+=</span> <span class="s">&#39;text/html&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="go">307 Temporary Redirect</span>
<span class="go">Content-Type: text/html; charset=UTF-8</span>
<span class="go">Location: http://localhost/path/to/foo</span>
<span class="go">Content-Length: 270</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go"> &lt;head&gt;</span>
<span class="go">  &lt;title&gt;307 Temporary Redirect&lt;/title&gt;</span>
<span class="go"> &lt;/head&gt;</span>
<span class="go"> &lt;body&gt;</span>
<span class="go">  &lt;h1&gt;307 Temporary Redirect&lt;/h1&gt;</span>
<span class="go">  The resource has been moved to &lt;a href=&quot;http://localhost/path/to/foo&quot;&gt;http://localhost/path/to/foo&lt;/a&gt;;</span>
<span class="go">you should be redirected automatically.</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go"> &lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>
</pre></div>
</div>
<p>This is taken from <a class="reference external" href="http://pythonpaste.org/module-paste.httpexceptions.html">paste.httpexceptions</a>, and if
you have Paste installed then these exceptions will be subclasses of
the Paste exceptions.</p>
<p>Note that on Python 2.4 and before, new-style classes could not be
used as exceptions.  <tt class="docutils literal"><span class="pre">Response</span></tt> objects must be new-style classes,
so this causes a bit of a conflict.  The base class
<tt class="docutils literal"><span class="pre">webob.exc.HTTPException</span></tt> <em>is</em> an exception, so you can catch that,
and it <em>is</em> a WSGI application.  But you may not be able to use
Response methods.  You can always get <tt class="docutils literal"><span class="pre">obj.exception</span></tt> to get an
exception that you can raise, and <tt class="docutils literal"><span class="pre">obj.wsgi_response</span></tt> to get the
<tt class="docutils literal"><span class="pre">Response</span></tt> object that you can use.</p>
<div class="section" id="conditional-wsgi-application">
<h3><a class="toc-backref" href="#id30">Conditional WSGI Application</a><a class="headerlink" href="#conditional-wsgi-application" title="Permalink to this headline">¶</a></h3>
<p>The Response object can handle your conditional responses for you,
checking If-None-Match, If-Modified-Since, and Range/If-Range.</p>
<p>To enable this you must create the response like
<tt class="docutils literal"><span class="pre">Response(conditional_request=True)</span></tt>, or make a subclass like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AppResponse</span><span class="p">(</span><span class="n">Response</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">default_content_type</span> <span class="o">=</span> <span class="s">&#39;text/html&#39;</span>
<span class="gp">... </span>    <span class="n">default_conditional_response</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">AppResponse</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="s">&#39;0123456789&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">last_modified</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mf">2005</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">UTC</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_modified_since</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mf">2006</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">UTC</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">&lt;Response ... 304 Not Modified&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">req</span><span class="o">.</span><span class="n">if_modified_since</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">etag</span> <span class="o">=</span> <span class="s">&#39;opaque-tag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span> <span class="o">=</span> <span class="s">&#39;opaque-tag&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">&lt;Response ... 304 Not Modified&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">req</span><span class="o">.</span><span class="n">if_none_match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&#39;content-range&#39;</span><span class="p">]</span>
<span class="go">&#39;bytes 1-4/10&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">body</span>
<span class="go">&#39;1234&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">WebOb Reference</a><ul>
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#id1">Request</a><ul>
<li><a class="reference external" href="#request-body">Request Body</a></li>
<li><a class="reference external" href="#method-url">Method &amp; URL</a></li>
<li><a class="reference external" href="#headers">Headers</a></li>
<li><a class="reference external" href="#query-post-variables">Query &amp; POST variables</a><ul>
<li><a class="reference external" href="#unicode-variables">Unicode Variables</a></li>
</ul>
</li>
<li><a class="reference external" href="#cookies">Cookies</a></li>
<li><a class="reference external" href="#modifying-the-request">Modifying the request</a></li>
<li><a class="reference external" href="#header-getters">Header Getters</a><ul>
<li><a class="reference external" href="#accept-headers">Accept-* headers</a></li>
<li><a class="reference external" href="#conditional-requests">Conditional Requests</a></li>
</ul>
</li>
<li><a class="reference external" href="#calling-wsgi-applications">Calling WSGI Applications</a></li>
<li><a class="reference external" href="#ad-hoc-attributes">Ad-Hoc Attributes</a></li>
</ul>
</li>
<li><a class="reference external" href="#id2">Response</a><ul>
<li><a class="reference external" href="#core-attributes">Core Attributes</a></li>
<li><a class="reference external" href="#id3">Headers</a></li>
<li><a class="reference external" href="#body-app-iter">Body &amp; app_iter</a></li>
<li><a class="reference external" href="#id4">Header Getters</a></li>
<li><a class="reference external" href="#id5">Cookies</a></li>
<li><a class="reference external" href="#binding-a-request">Binding a Request</a></li>
<li><a class="reference external" href="#response-as-a-wsgi-application">Response as a WSGI application</a></li>
</ul>
</li>
<li><a class="reference external" href="#exceptions">Exceptions</a><ul>
<li><a class="reference external" href="#conditional-wsgi-application">Conditional WSGI Application</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">WebOb</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="modules/webob.html"
                                  title="next chapter"><tt class="docutils literal docutils literal docutils literal"><span class="pre">webob</span></tt> &#8211; Request/Response objects</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/reference.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules/webob.html" title="webob – Request/Response objects"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="WebOb"
             >previous</a> |</li>
        <li><a href="index.html">WebOb v0.9.8 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, Ian Bicking.
      Last updated on Feb 03, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.3.
    </div>
  </body>
</html>